syntax = "proto3";

package framework;

option go_package = "github.com/lk2023060901/xiaojia-proto-framework;framework";

import "err_code.proto";

// InternalNodeService Game 节点间内部通信服务
service InternalNodeService {
  // SyncUserAction [玩家节点 -> 主播节点]
  // 场景：玩家在分配到的 Game 节点扣费后，通知主播所在的 Game 节点更新玩法状态
  rpc SyncUserAction(SyncUserActionReq) returns (SyncUserActionRes);

  // SyncUserReward [主播节点 -> 玩家节点]
  // 场景：主播房间所在的 Game 节点产生结算后，通知玩家所在的 Game 节点增加资产/经验
  rpc SyncUserReward(SyncUserRewardReq) returns (SyncUserRewardRes);
}

// SyncUserActionReq 同步玩家操作请求
message SyncUserActionReq {
  uint64 uid = 1;            // 玩家UID
  string anchor_open_id = 2; // 目标主播ID
  uint32 action_type = 3;    // 动作类型
  bytes action_data = 4;     // 业务序列化数据
}

// SyncUserActionRes 同步玩家操作响应
message SyncUserActionRes {
  ErrCode code = 1;          // 错误码
}

// SyncUserRewardReq 同步玩家奖励请求
message SyncUserRewardReq {
  uint64 uid = 1;            // 玩家UID
  uint32 reward_type = 2;    // 奖励类型
  bytes reward_data = 3;     // 业务序列化数据
}

// SyncUserRewardRes 同步玩家奖励响应
message SyncUserRewardRes {
  ErrCode code = 1;          // 错误码
}